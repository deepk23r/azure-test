# conftest policy to evaluate results for vulnerability issues
package main

deny[msg] {

  severities := ["High", "Critical"]
  input.vulnerabilities.matches[i].vulnerability.severity == severities[j]

  msg = sprintf(
      "%s - Found %s software vulnerability: %s",
      [ "vulnerability.rego failed",
        input.vulnerabilities.matches[i].vulnerability.severity,
        input.vulnerabilities.matches[i].vulnerability.id ] )
}
